name: Build Image Caller Workflow

on:
  workflow_dispatch:
  release:
    types: [published]
  push:
    branches: ["**"]

permissions: {}

jobs:
  test-download:
    permissions:
      attestations: read
      contents: read
    runs-on: ubuntu-latest
    env:
      GH_TOKEN: ${{ github.token }}
    steps:
      - name: Download Image
        run: |
          gh release download \
            --repo liatrio/demo-gh-autogov-policy-library \
            --pattern "bundle.tar.gz"

  # attest-image-hp: #image
  #   permissions:
  #     id-token: write
  #     attestations: write
  #     packages: write
  #     contents: write
  #   uses: liatrio/demo-gh-autogov-workflows/.github/workflows/rw-hp-build-image.yaml@72fce8087349ddd2de19a34265efd211ffed7a37
  #   secrets: inherit
  #   with:
  #     subject-name: ghcr.io/${{ github.repository }}
  #     cert-identity: https://github.com/liatrio/demo-gh-autogov-workflows/.github/workflows/rw-hp-attest-image.yaml@72fce8087349ddd2de19a34265efd211ffed7a37
